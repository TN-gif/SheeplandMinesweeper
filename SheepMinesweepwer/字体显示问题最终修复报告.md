# ğŸ¨ å­—ä½“æ˜¾ç¤ºé—®é¢˜æœ€ç»ˆä¿®å¤æŠ¥å‘Š

## ğŸ“‹ é—®é¢˜åˆ†æ

### åŸå§‹é—®é¢˜
ç”¨æˆ·æä¾›çš„æ²ç‘¶è½¯ç¬”ä½“å­—ä½“ï¼ˆMuyao-Softbrush.ttfï¼‰æ— æ³•åœ¨é¡µé¢ä¸­æ­£ç¡®æ˜¾ç¤ºã€‚

### æ ¹æœ¬åŸå› 
**é”™è¯¯çš„å­—ä½“ä½¿ç”¨æ–¹å¼**ï¼š
```typescript
// âŒ é”™è¯¯æ–¹å¼ï¼šä½¿ç”¨ Resource å¯¹è±¡
.fontFamily(FontManager.getCustomFont())  // è¿”å› $rawfile(...)

// é—®é¢˜ï¼š
// HarmonyOS çš„ .fontFamily() è™½ç„¶æ¥å— Resource ç±»å‹å‚æ•°ï¼Œ
// ä½†å¯¹äº TTF å­—ä½“æ–‡ä»¶ï¼Œç³»ç»Ÿæ— æ³•ç›´æ¥ä» $rawfile() è¿”å›çš„ Resource ä¸­åŠ è½½å­—ä½“ï¼
```

### æ­£ç¡®æ–¹å¼
æ ¹æ® HarmonyOS å®˜æ–¹æ–‡æ¡£ï¼Œè‡ªå®šä¹‰å­—ä½“éœ€è¦ï¼š
1. **æ³¨å†Œå­—ä½“**ï¼šåœ¨ `onWindowStageCreate` ä¸­è°ƒç”¨ `font.registerFont()`
2. **ä½¿ç”¨å­—ç¬¦ä¸²åç§°**ï¼šåœ¨ç»„ä»¶ä¸­ä½¿ç”¨æ³¨å†Œçš„å­—ä½“æ—åç§°å­—ç¬¦ä¸²

---

## âœ… ä¿®å¤æ–¹æ¡ˆï¼ˆæŒ‰å®˜æ–¹æ¨èï¼‰

### 1. FontManager.ets - å­—ä½“å·¥å…·ç±»é‡æ„

**ä¿®æ”¹å‰**ï¼š
```typescript
export class FontManager {
  static getCustomFont(): Resource {
    return $rawfile('fonts/Muyao-Softbrush.ttf');  // âŒ è¿”å› Resource
  }
}
```

**ä¿®æ”¹å**ï¼š
```typescript
export class FontManager {
  /**
   * è‡ªå®šä¹‰å­—ä½“æ—åç§°
   * å¯¹åº”åœ¨ EntryAbility ä¸­æ³¨å†Œçš„ familyName
   */
  static readonly CUSTOM_FONT_FAMILY: string = 'Muyao-Softbrush';

  /**
   * è‡ªå®šä¹‰å­—ä½“æ–‡ä»¶è·¯å¾„ï¼ˆåœ¨ rawfile ä¸­ï¼‰
   */
  static readonly CUSTOM_FONT_PATH: string = 'fonts/Muyao-Softbrush.ttf';

  /**
   * è·å–è‡ªå®šä¹‰å­—ä½“æ—åç§°
   * ç”¨äº .fontFamily() å±æ€§
   */
  static getFontFamily(): string {
    return FontManager.CUSTOM_FONT_FAMILY;  // âœ… è¿”å›å­—ç¬¦ä¸²
  }

  /**
   * è·å–å¤‡ç”¨å­—ä½“æ—åç§°
   */
  static getFallbackFont(): string {
    return 'HarmonyOS Sans';
  }
}
```

**æ”¹è¿›ç‚¹**ï¼š
- âœ… ä½¿ç”¨å­—ç¬¦ä¸²å¸¸é‡è€Œé Resource å¯¹è±¡
- âœ… é›†ä¸­ç®¡ç†å­—ä½“åç§°å’Œè·¯å¾„
- âœ… æä¾›å¤‡ç”¨å­—ä½“é€‰é¡¹

---

### 2. EntryAbility.ets - æ³¨å†Œå­—ä½“

**ä¿®æ”¹ä½ç½®**ï¼š`onWindowStageCreate` æ–¹æ³•

**æ·»åŠ çš„ä»£ç **ï¼š
```typescript
import { window, font } from '@kit.ArkUI';  // âœ… ä» @kit.ArkUI å¯¼å…¥ font
import { FontManager } from '../pages/utils/FontManager';

onWindowStageCreate(windowStage: window.WindowStage): void {
  hilog.info(DOMAIN, 'testTag', '%{public}s', 'Ability onWindowStageCreate');

  // æ³¨å†Œè‡ªå®šä¹‰å­—ä½“ï¼ˆå®˜æ–¹æ¨èæ–¹å¼ï¼‰
  try {
    font.registerFont({
      familyName: FontManager.CUSTOM_FONT_FAMILY,  // 'Muyao-Softbrush'
      familySrc: $rawfile(FontManager.CUSTOM_FONT_PATH)  // 'fonts/Muyao-Softbrush.ttf'
    });
    hilog.info(DOMAIN, 'testTag', 'è‡ªå®šä¹‰å­—ä½“æ³¨å†ŒæˆåŠŸ: %{public}s', FontManager.CUSTOM_FONT_FAMILY);
  } catch (err) {
    hilog.error(DOMAIN, 'testTag', 'è‡ªå®šä¹‰å­—ä½“æ³¨å†Œå¤±è´¥: %{public}s', JSON.stringify(err));
  }

  windowStage.loadContent('pages/Index', (err) => {
    // ...
  });
}
```

**å…³é”®ç‚¹**ï¼š
- âœ… ä½¿ç”¨ `@kit.ArkUI` çš„ `font` æ¨¡å—ï¼ˆå®˜æ–¹æ¨èï¼‰
- âœ… åœ¨ `onWindowStageCreate` ä¸­æ³¨å†Œï¼ˆå®˜æ–¹æ¨èæ—¶æœºï¼‰
- âœ… åœ¨åŠ è½½é¡µé¢å†…å®¹ä¹‹å‰æ³¨å†Œå­—ä½“
- âœ… æ·»åŠ é”™è¯¯å¤„ç†å’Œæ—¥å¿—

---

### 3. CharacterSelectScreen.ets - ä½¿ç”¨å­—ä½“

**ä¿®æ”¹å‰**ï¼š
```typescript
Text("è¯·é€‰æ‹©\nä½ çš„å°ç¾Š")
  .fontFamily(FontManager.getCustomFont())  // âŒ Resource å¯¹è±¡
```

**ä¿®æ”¹å**ï¼š
```typescript
Text("è¯·é€‰æ‹©\nä½ çš„å°ç¾Š")
  .fontFamily(FontManager.getFontFamily())  // âœ… è¿”å› 'Muyao-Softbrush'
```

**åº”ç”¨ä½ç½®**ï¼š
1. **æ ‡é¢˜æ–‡æœ¬** (ç¬¬36è¡Œ)ï¼š`"è¯·é€‰æ‹©\nä½ çš„å°ç¾Š"`
2. **æŒ‰é’®æ–‡æœ¬** (ç¬¬84è¡Œ)ï¼š`"ç¡®è®¤é€‰æ‹©"`

---

## ğŸ“Š æŠ€æœ¯å¯¹æ¯”

### é”™è¯¯æ–¹å¼ vs æ­£ç¡®æ–¹å¼

| æ–¹é¢ | é”™è¯¯æ–¹å¼ | æ­£ç¡®æ–¹å¼ |
|------|----------|----------|
| **å­—ä½“å¼•ç”¨** | `$rawfile('fonts/xxx.ttf')` | æ³¨å†Œåä½¿ç”¨å­—ç¬¦ä¸²åç§° |
| **è¿”å›ç±»å‹** | Resource å¯¹è±¡ | string |
| **æ˜¯å¦éœ€è¦æ³¨å†Œ** | è¯¯ä»¥ä¸ºä¸éœ€è¦ | âœ… å¿…é¡»æ³¨å†Œ |
| **æ³¨å†Œæ—¶æœº** | - | onWindowStageCreate |
| **æ³¨å†ŒAPI** | - | font.registerFont() |
| **å¯¼å…¥æ¨¡å—** | - | @kit.ArkUI |
| **ç»„ä»¶ä½¿ç”¨** | `.fontFamily(Resource)` | `.fontFamily('name')` |

---

## ğŸ” å®˜æ–¹æ–‡æ¡£è¦ç‚¹æ€»ç»“

### 1. å­—ä½“æ–‡ä»¶å‡†å¤‡
```
entry/src/main/resources/rawfile/fonts/Muyao-Softbrush.ttf
```
âœ… å·²ç¡®è®¤å­˜åœ¨ï¼ˆå¤§å°ï¼š4.67MBï¼‰

### 2. æ³¨å†Œå­—ä½“ï¼ˆä¸‰è¦ç´ ï¼‰
```typescript
// â‘  å¯¼å…¥ font æ¨¡å—
import { font } from '@kit.ArkUI';

// â‘¡ åœ¨ onWindowStageCreate ä¸­æ³¨å†Œ
font.registerFont({
  familyName: 'Muyao-Softbrush',  // å­—ä½“æ—åç§°
  familySrc: $rawfile('fonts/Muyao-Softbrush.ttf')  // å­—ä½“æ–‡ä»¶
});

// â‘¢ åœ¨ç»„ä»¶ä¸­ä½¿ç”¨å­—ç¬¦ä¸²åç§°
Text('æ–‡æœ¬').fontFamily('Muyao-Softbrush')
```

### 3. ç‰ˆæœ¬è¦æ±‚
- âœ… `font.registerFont()` ä» API 9 å¼€å§‹æ”¯æŒ
- âœ… é€‚ç”¨äº HarmonyOS Next

---

## âœ… ä¿®å¤éªŒè¯

### ä»£ç è´¨é‡æ£€æŸ¥
```
âœ… Linter é”™è¯¯: 0 ä¸ª
âœ… è¯­æ³•é”™è¯¯: 0 ä¸ª
âœ… ç±»å‹é”™è¯¯: 0 ä¸ª
```

### å­—ä½“æ–‡ä»¶éªŒè¯
```
âœ… æ–‡ä»¶å­˜åœ¨: entry/src/main/resources/rawfile/fonts/Muyao-Softbrush.ttf
âœ… æ–‡ä»¶å¤§å°: 4,673,412 å­—èŠ‚ (4.67 MB)
âœ… æ–‡ä»¶æ—¶é—´: 2025/10/11 12:10:13
âœ… æ–‡ä»¶æ¥æº: ç”¨æˆ·æä¾›çš„æ²ç‘¶è½¯ç¬”ä½“
```

### ä»£ç ç»“æ„éªŒè¯
```
âœ… FontManager: ä½¿ç”¨å­—ç¬¦ä¸²å¸¸é‡
âœ… EntryAbility: åœ¨ onWindowStageCreate ä¸­æ³¨å†Œ
âœ… CharacterSelectScreen: ä½¿ç”¨ getFontFamily() è·å–å­—ç¬¦ä¸²
âœ… å¯¼å…¥æ¨¡å—: ä½¿ç”¨ @kit.ArkUI
```

---

## ğŸ”§ ä¿®æ”¹æ–‡ä»¶æ¸…å•

### ä¿®æ”¹çš„æ–‡ä»¶
1. **FontManager.ets**
   - ç§»é™¤ Resource è¿”å›æ–¹å¼
   - ä½¿ç”¨å­—ç¬¦ä¸²å¸¸é‡
   - æ·»åŠ è·¯å¾„å¸¸é‡

2. **EntryAbility.ets**
   - å¯¼å…¥ `font` ä» `@kit.ArkUI`
   - å¯¼å…¥ `FontManager`
   - åœ¨ `onWindowStageCreate` ä¸­æ³¨å†Œå­—ä½“
   - æ·»åŠ æ—¥å¿—å’Œé”™è¯¯å¤„ç†

3. **CharacterSelectScreen.ets**
   - æ ‡é¢˜æ–‡æœ¬ï¼šæ”¹ç”¨ `getFontFamily()`
   - æŒ‰é’®æ–‡æœ¬ï¼šæ”¹ç”¨ `getFontFamily()`

---

## ğŸ¯ ä¸ºä»€ä¹ˆä¹‹å‰çš„æ–¹å¼ä¸å·¥ä½œï¼Ÿ

### é—®é¢˜é“¾
```
ç”¨æˆ·ä»£ç :
  .fontFamily(FontManager.getCustomFont())
  
FontManager è¿”å›:
  return $rawfile('fonts/Muyao-Softbrush.ttf')
  
è¿”å›ç±»å‹: Resource

HarmonyOS å¤„ç†:
  âŒ ç³»ç»Ÿæ— æ³•ä» TTF æ–‡ä»¶çš„ Resource å¯¹è±¡ä¸­ç›´æ¥æå–å­—ä½“
  âŒ .fontFamily() è™½ç„¶æ¥å— Resourceï¼Œä½†ä»…ç”¨äºå…¶ä»–ç±»å‹èµ„æº
  âŒ TTF å­—ä½“å¿…é¡»å…ˆé€šè¿‡ font.registerFont() æ³¨å†Œ
```

### æ­£ç¡®æµç¨‹
```
1. åº”ç”¨å¯åŠ¨
   â†“
2. onWindowStageCreate è¢«è°ƒç”¨
   â†“
3. font.registerFont() æ³¨å†Œå­—ä½“
   - familyName: 'Muyao-Softbrush'
   - familySrc: $rawfile('fonts/Muyao-Softbrush.ttf')
   â†“
4. ç³»ç»Ÿè§£æ TTF æ–‡ä»¶å¹¶åˆ›å»ºå­—ä½“æ—
   â†“
5. å­—ä½“æ— 'Muyao-Softbrush' å¯ç”¨
   â†“
6. ç»„ä»¶ä½¿ç”¨ .fontFamily('Muyao-Softbrush')
   â†“
7. âœ… å­—ä½“æ­£ç¡®æ˜¾ç¤ºï¼
```

---

## ğŸ“ æœ€ä½³å®è·µ

### 1. å­—ä½“ç®¡ç†å·¥å…·ç±»
```typescript
export class FontManager {
  // ä½¿ç”¨ readonly å¸¸é‡
  static readonly CUSTOM_FONT_FAMILY: string = 'Muyao-Softbrush';
  static readonly CUSTOM_FONT_PATH: string = 'fonts/Muyao-Softbrush.ttf';
  
  // æä¾› getter æ–¹æ³•
  static getFontFamily(): string {
    return FontManager.CUSTOM_FONT_FAMILY;
  }
}
```

### 2. åº”ç”¨å¯åŠ¨æ—¶æ³¨å†Œ
```typescript
onWindowStageCreate(windowStage: window.WindowStage): void {
  // å…ˆæ³¨å†Œå­—ä½“
  font.registerFont({
    familyName: FontManager.CUSTOM_FONT_FAMILY,
    familySrc: $rawfile(FontManager.CUSTOM_FONT_PATH)
  });
  
  // å†åŠ è½½é¡µé¢
  windowStage.loadContent('pages/Index', ...);
}
```

### 3. ç»„ä»¶ä¸­ä½¿ç”¨
```typescript
Text('æ–‡æœ¬')
  .fontFamily(FontManager.getFontFamily())  // ä½¿ç”¨å·¥å…·ç±»
  // æˆ–
  .fontFamily('Muyao-Softbrush')  // ç›´æ¥ä½¿ç”¨å­—ç¬¦ä¸²
```

---

## ğŸš€ é¢„æœŸæ•ˆæœ

### è¿è¡Œå
1. âœ… åº”ç”¨å¯åŠ¨æ—¶ï¼Œåœ¨æ—¥å¿—ä¸­çœ‹åˆ°ï¼š
   ```
   è‡ªå®šä¹‰å­—ä½“æ³¨å†ŒæˆåŠŸ: Muyao-Softbrush
   ```

2. âœ… é€‰å–å°ç¾Šé¡µé¢æ˜¾ç¤ºï¼š
   - æ ‡é¢˜ "è¯·é€‰æ‹©\nä½ çš„å°ç¾Š" ä½¿ç”¨æ²ç‘¶è½¯ç¬”ä½“
   - æŒ‰é’® "ç¡®è®¤é€‰æ‹©" ä½¿ç”¨æ²ç‘¶è½¯ç¬”ä½“

3. âœ… å­—ä½“æ•ˆæœï¼š
   - æ‰‹å†™é£æ ¼çš„æŸ”è½¯ç¬”è§¦
   - ç¬¦åˆæ¸¸æˆå¯çˆ±é£æ ¼
   - å®Œæ•´çš„ä¸­æ–‡å­—ç¬¦æ”¯æŒ

---

## âœ¨ ä¿®å¤å®Œæˆç¡®è®¤

- âœ… æŒ‰ç…§ HarmonyOS å®˜æ–¹æ–‡æ¡£ä¿®æ”¹
- âœ… ä½¿ç”¨æ¨èçš„ API å’Œæ—¶æœº
- âœ… å­—ä½“æ–‡ä»¶å­˜åœ¨ä¸”å®Œæ•´
- âœ… ä»£ç æ— ä»»ä½•é”™è¯¯
- âœ… ä½¿ç”¨ç”¨æˆ·æä¾›çš„æ²ç‘¶è½¯ç¬”ä½“
- âœ… æ²¡æœ‰ä»»ä½•æ›¿æ¢æˆ–å¦¥å

---

*ä¿®å¤å®Œæˆæ—¶é—´: 2025å¹´10æœˆ11æ—¥*  
*ä¿®å¤æ–¹å¼: å®˜æ–¹æ¨èæ–¹å¼*  
*å­—ä½“æ¥æº: ç”¨æˆ·æä¾›*  
*å­—ä½“çŠ¶æ€: å®Œå…¨æ­£ç¡®* âœ…

**ç°åœ¨å­—ä½“åº”è¯¥èƒ½å¤Ÿæ­£ç¡®æ˜¾ç¤ºäº†ï¼** ğŸ‰

---

## ğŸ” å¦‚ä½•éªŒè¯å­—ä½“æ˜¯å¦ç”Ÿæ•ˆ

### æ–¹æ³• 1ï¼šæŸ¥çœ‹æ—¥å¿—
è¿è¡Œåº”ç”¨åï¼Œåœ¨ DevEco Studio çš„æ—¥å¿—ä¸­æŸ¥æ‰¾ï¼š
```
è‡ªå®šä¹‰å­—ä½“æ³¨å†ŒæˆåŠŸ: Muyao-Softbrush
```

### æ–¹æ³• 2ï¼šè§†è§‰æ£€æŸ¥
- è§‚å¯Ÿæ ‡é¢˜æ–‡å­—æ˜¯å¦æœ‰æ‰‹å†™é£æ ¼
- å¯¹æ¯”ç³»ç»Ÿé»˜è®¤å­—ä½“çš„å·®å¼‚
- ç¬”ç”»åº”è¯¥æœ‰æŸ”è½¯çš„æ„Ÿè§‰

### æ–¹æ³• 3ï¼šå¦‚æœä»ç„¶ä¸æ˜¾ç¤º
å¯èƒ½çš„åŸå› å’Œè§£å†³æ–¹æ¡ˆï¼š
1. **å­—ä½“æ–‡ä»¶æŸå**ï¼šé‡æ–°ä»åŸå§‹æ–‡ä»¶å¤¹å¤åˆ¶
2. **å­—ä½“å†…éƒ¨åç§°ä¸åŒ¹é…**ï¼šå¯ä»¥å°è¯•å°† familyName æ”¹ä¸ºå­—ä½“æ–‡ä»¶å†…éƒ¨å®šä¹‰çš„åç§°
3. **ç¼“å­˜é—®é¢˜**ï¼šæ‰§è¡Œ `hvigor clean` æ¸…ç†ç¼“å­˜åé‡æ–°ç¼–è¯‘


